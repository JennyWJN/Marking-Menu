<!DOCTYPE html>
<html>

<head>
  <link href="./marking-menu.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, user-scalable=no" />
  <style>
    body,
    html,
    #main {
      padding: 0;
      margin: 0;
      height: 100%;
    }

    #toast-wrapper {
      pointer-events: none;
      position: fixed;
      top: 50px;
      width: 100%;
      text-align: center;
    }

    #toast {
      background-color: rgba(0, 0, 0, .8);
      color: white;
      font-weight: bolder;
      border-radius: 5px;
      padding: 10px 20px;
      opacity: 0;
      transition: 400ms;
    }

    #toast.shown {
      opacity: 1;
    }
  </style>
</head>

<body>
  <div id="toast-wrapper">
    <span id="toast"></span>
  </div>
  <div id="main"></div>

  <script src="./demo-libs/Rx.min.js"></script>
  <script src="./marking-menu.js"></script>
  <script>
    'use strict';

    // Create an array containing the integers from start to count - start.
    function range(start, count) {
      return Array.apply(0, Array(count))
        .map(function (element, index) {
          return index + start;
        });
    }

    // Create the toast.
    var toastMessage = (function (dom) {
      var timeoutId = null;
      return function (message) {
        clearTimeout(timeoutId);
        dom.innerHTML = message;
        dom.classList.add('shown');
        timeoutId = setTimeout(function () {
          dom.classList.remove('shown');
        }, 1000);
      }
    })(document.getElementById('toast'));

    // Create the marking menu.
    var mm = (function (dom) {
      function createItem(itemNum) {
        return { name: 'item ' + itemNum }; 
      }
      // Create the submenu.
      var submenu = {
        name: 'others...',
        children: range(7, 4).map(createItem)
      }
      // Create the items.
      var items = range(1, 2).map(createItem).concat(
        [submenu],
        range(3, 5).map(createItem)
      );
      return MarkingMenu(items, main);
    })(document.getElementById('main'))

    // Toast the marking menu's selections.
    mm.subscribe({
      next(selection) { toastMessage(selection.name) },
      error(error) { console.error(error); }
    });
  </script>
</body>

</html>